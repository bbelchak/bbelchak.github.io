<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Latest Posts &#8211; Belchak.com</title>
<meta name="description" content="Describe this nonsense.">
<meta name="keywords" content="Jekyll, theme, themes, responsive, blog, modern">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/abstract-1.jpg">

<meta name="twitter:title" content="Latest Posts">
<meta name="twitter:description" content="Describe this nonsense.">
<meta name="twitter:creator" content="@BenBelchak">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Latest Posts">
<meta property="og:description" content="Describe this nonsense.">
<meta property="og:url" content="/page2/index.html">
<meta property="og:site_name" content="Belchak.com">





<link rel="canonical" href="/page2/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Belchak.com Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/avatar.jpg" alt="Ben Belchak photo" class="author-photo">
					<h4>Ben Belchak</h4>
					<p>Husband, father of four, Head of Site Reliability Engineering at Shazam. American in London.</p>
				</li>
				<li><a href="/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:ben@belchak.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/BenBelchak"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="https://facebook.com/hekman"><i class="fa fa-fw fa-facebook"></i> Facebook</a>
				</li>
				
				<li>
					<a href="https://linkedin.com/in/belchak"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="https://github.com/bbelchak"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				<li>
					<a href="ben-belchak"><i class="fa fa-fw fa-stack-exchange"></i> Stackexchange</a>
				</li>
				<li>
					<a href="https://instagram.com/bbelchak"><i class="fa fa-fw fa-instagram"></i> Instagram</a>
				</li>
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="/posts/">All Posts</a></li>
				<li><a href="/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  <div class="image-credit">Image source: <a href="http://www.dargadgetz.com/ios-7-abstract-wallpaper-pack-for-iphone-5-and-ipod-touch-retina/">dargadgetz</a></div><!-- /.image-credit -->
  
    <div class="entry-image">
      <img src="/images/abstract-1.jpg" alt="Latest Posts">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Belchak.com</h1>
      <h2>Latest Posts</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2011-06-24T12:06:13+01:00"><a href="/2011/06/24/campy-the-python-campfire-bot/">June 24, 2011</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Ben Belchak">Ben Belchak</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2011/06/24/campy-the-python-campfire-bot/" rel="bookmark" title="Campy: the Python Campfire Bot" itemprop="url">Campy: the Python Campfire Bot</a></h1>
    
  </header>
  <div class="entry-content">
    <p>We use a <a href="http://www.campfirenow.com">Campfire</a> at <a href="http://www.needle.com">Needle</a> for our day-to-day communication between our tech team members and other business members. We really like Campfire’s ability to store files, conference call and keep transcripts even when you are not logged in. We get <a href="http://github.com">GitHub</a> commit messages, <a href="http://pivotaltracker.com">Pivotal Tracker</a> story updates and more scattered in our conversations.</p>

<p>These one-way updates are very nice, but I thought it would be nice to be able to have a bot that sat in the channel and could take commands from anybody and do more complex tasks for us without us ever having to leave Campfire. To solve this problem, I wrote <a href="http://www.github.com/bbelchak/campy">Campy</a>, a pure Python Campfire bot with an extensible plugin system.</p>

<p>The first plugin I wrote as a proof of concept is a Google image search plugin. You tell the bot some search parameters that you would like it to search for, and you get back an image inline in your chat transcript. Don’t worry, safe search is on by default so you don’t get any NSFW images back.</p>

<p>The second plugin I wrote was the all-important Pivotal Tracker plugin. This plugin lets you do the following:</p>

<ul>
  <li>
    <p><code>pt story create "Title" "Description" bug|feature|chore|release</code> – Create a story</p>
  </li>
  <li>
    <p><code>pt getmine started|finished|delivered|accepted|rejected|unstarted|unscheduled</code> – Get a list of all stories that belong to you</p>
  </li>
  <li>
    <p><code>pt start #story_id</code> – Start a particular story.</p>
  </li>
  <li>
    <p><code>pt start|tell next bug|feature|chore [mine]</code> – Start or tell the next story of a given type. Optionally supply ‘mine’ at the end of the message to only work on your own stories.</p>
  </li>
</ul>

<p>The plugins system is very extensible, so you can create a plugin to do pretty much anything!</p>

<p>You can get Campy here:  <a href="https://github.com/bbelchak/campy">https://github.com/bbelchak/campy</a></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2011-03-04T12:31:14+00:00"><a href="/2011/03/04/workfit-standing-desk/">March 04, 2011</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Ben Belchak">Ben Belchak</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2011/03/04/workfit-standing-desk/" rel="bookmark" title="Ergotron WorkFit-S Standing Desk Review " itemprop="url">Ergotron WorkFit-S Standing Desk Review </a></h1>
    
  </header>
  <div class="entry-content">
    <p>A few months ago, I started investigating the health benefits of standing while I work at my computer. The benefits are myriad, and include:</p>

<ul>
  <li>
    <p><strong>More calories burned</strong>. Standing at a desk while you work can actually burn around 300 calories per day more than sitting.</p>
  </li>
  <li>
    <p><strong>Standing at a desk helps people with back problems</strong>. Humans were not made for sitting, and doing so for long periods of time can be really hard on your hips and lower back.</p>
  </li>
  <li>
    <p><strong>Improved posture.</strong> Standing can help improve your posture, which can relieve pain in your lower and upper back, and neck.</p>
  </li>
  <li>
    <p><strong>More breaks.</strong> I find that I take more breaks, which makes me happier and healthier. While standing, it is easier to just walk away instead of hauling yourself out of a chair.</p>
  </li>
</ul>

<p>After my research, I decided to convert my cheap IKEA desk into a standing desk by raising the legs up as far as they could go and then stacking books and Rubbermaid bins to get the height on the keyboard and monitors right. Here’s what I ended up with:</p>

<p><img class="left" src="http://www.belchak.com/wp-content/uploads/2011/03/IMG_0042.jpg" width="224" height="224" /></p>

<p>As you can see, it is less than ideal. It forced me to stand 100% of the time, and in order to take a break from standing, I needed to disconnect my laptop from everything and take it to a chair. Not awesome.</p>

<p>I reverted back to a sitting desk, and kept wishing for a standing option that would allow me to quickly change to a sitting position if I got tired, without having to deal with completely rearranging my work area.</p>

<p>Then, I discovered the Ergotron WorkFit-S while searching around for standing desk options. I loved the youtube video I found here:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/lK4yYENEtHA" frameborder="0" allowfullscreen=""></iframe>

<p>I bought the WorkFit-S Combo (laptop + LCD) on Amazon with overnight shipping with my Amazon Prime account, and it arrived very quickly. I was a bit worried because the tech specs indicated that the maximum monitor size is 20” while using a laptop. I spoke with one of their marketing people on Twitter, and they were very helpful, checking with their support staff and product managers to provide me with any tips that they could dig up while I anxiously awaited the FedEx delivery guy.</p>

<p>When I received it, I immediately installed it on my desk. It took approximately 15 minutes to get it built and installed on my desk. My 24” LCD fit perfectly on the right, with my laptop on the left. I think the concern with the size of the monitor is not necessarily the size, but the weight. I could probably fit a 27” on here without a problem if it was light enough. My LCD and laptop are probably right on the edge of the maximum weight. Since the up and down motion is achieved with a pulley system, I had to adjust the tension a bit to get the balance right.</p>

<p><img src="http://www.belchak.com/wp-content/uploads/2011/03/IMG_0253-224x300.jpg" /></p>

<p>I did have to move it after I’d installed it in the center of my corner desk because the mouse tray kept hitting the desk where it curves.</p>

<p>The thing will attach to virtually any surface, but they also make a wheeled cart that has similar features.</p>

<p><img src="http://www.belchak.com/wp-content/uploads/2011/03/IMG_0252-224x300.jpg" /></p>

<p>I am very happy with it so far, and I look forward to reaping the benefits of standing, while having the option to sit!</p>

<p>The Ergotron WorkFit retails for around $399 and you can find them on <a href="http://www.amazon.com/s/ref=nb_sb_noss?url=search-alias%3Daps&amp;field-keywords=workfit-s&amp;x=0&amp;y=0">Amazon.com</a> or elsewhere.</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2011-02-07T19:44:24+00:00"><a href="/2011/02/07/unit-testing-django-with-a-nosql-backend/">February 07, 2011</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Ben Belchak">Ben Belchak</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2011/02/07/unit-testing-django-with-a-nosql-backend/" rel="bookmark" title="Unit Testing Django with a NoSQL Backend" itemprop="url">Unit Testing Django with a NoSQL Backend</a></h1>
    
  </header>
  <div class="entry-content">
    <p>In my previous post about <a href="http://www.belchak.com/2011/02/05/unit-testing-your-django-application/">unit testing for django</a>, I laid the groundwork for how to unit test any django application. One nice feature that django includes with its test framework is the test database syncing. Even better is if you are using <a href="http://www.belchak.com/2011/01/27/django-database-migrations-with-south/">South</a> to do database migrations - it will run the migrations in  your test environment for you.</p>

<p>However, what if you are using a NoSQL database backend like MongoDB, Cassandra, CouchDB or something similar and you aren’t using the Django ORM? How do you handle setting up and tearing down the database environments?</p>

<p>The good news is that Python’s unittest framework makes this easy. You can override the <code>setUp()</code> and <code>tearDown()</code> on each TestCase that you build. Here is a snippet to get you started:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pymongo</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="c"># It would be best to define this in a utility class somewhere</span>
<span class="k">def</span> <span class="nf">get_db</span><span class="p">(</span><span class="n">db_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">""" GetDB - simple function to wrap getting a database
    connection from the connection pool.
    """</span>
    <span class="k">return</span> <span class="n">pymongo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">MONGO_HOST</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">MONGO_PORT</span><span class="p">)[</span><span class="nb">getattr</span><span class="p">(</span>
                <span class="n">settings</span><span class="p">,</span> <span class="s">"MONGO_DBNAME_PREFIX"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span> <span class="o">+</span>
                <span class="p">(</span><span class="n">db_name</span> <span class="ow">or</span> <span class="n">settings</span><span class="o">.</span><span class="n">MONGO_DBNAME</span><span class="p">)]</span>

<span class="k">class</span> <span class="nc">MyTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">fixtures</span> <span class="o">=</span> <span class="p">[</span><span class="s">'test_data.json'</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">get_db</span><span class="p">(</span><span class="s">'test'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">create_collection</span><span class="p">(</span><span class="s">'mytestcollection'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_doc_published</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Set up a document to save</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">"test"</span><span class="p">,</span>
                      <span class="n">user_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">mytestcollection</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">mytestcollection</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span>
            <span class="p">{</span><span class="s">'user_id'</span><span class="p">:</span><span class="mi">1</span><span class="p">})[</span><span class="s">'text'</span><span class="p">],</span> <span class="s">'test'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">drop_collection</span><span class="p">(</span><span class="s">'mytestcollection'</span><span class="p">)</span></code></pre></div>

<p>What this does is <code>setUp()</code> a collection in the <code>mytestcollection</code> collection, runs the <code>my_doc_published</code> test and then tears down the test database environment by dropping the <code>mytestcollection</code> collection.</p>

<p>Things to remember for <code>setUp()</code> and <code>tearDown()</code>:</p>

<ul>
  <li>
    <p><code>setUp()</code> is called before every test method in your TestCase class.</p>
  </li>
  <li>
    <p><code>tearDown()</code> is called after every test method in your TestCase class.</p>
  </li>
  <li>
    <p><code>tearDown()</code> is called even if your test methods fail or error out.</p>
  </li>
</ul>

<p>And there you have it! Django makes testing even non-ORM datasources a snap, if you know how to wire it up.
<strong>UPDATE:</strong> Some would say that database fixtures and setting up/tearing down database environments as part of your unit tests is not “unit testing”. This is not entirely accurate, because in order to do unit tests that rely on backend data, you <strong>must</strong> instantiate and tear down pristine database environments.</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2011-02-05T21:33:40+00:00"><a href="/2011/02/05/unit-testing-your-django-application/">February 05, 2011</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Ben Belchak">Ben Belchak</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~3 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2011/02/05/unit-testing-your-django-application/" rel="bookmark" title="Unit Testing Your Django Application" itemprop="url">Unit Testing Your Django Application</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Unit testing is a very important part of any software project. It helps you know that the new code you are deploying works, and isn’t going to blow up in your face. It also helps you feel good about changing large chunks of code without destroying everything you’ve done for the last 3 years.</p>

<p>Unit testing with django is as simple as pie. <a href="http://docs.djangoproject.com/en/dev/topics/testing/">The documentation</a> is very good, and you can learn a lot about more advanced testing methods from <a href="http://docs.python.org/library/unittest.html">the python documentation</a>. In this blog post, I aim to show a quick way to get up and running with testing your django application.</p>

<p>First, if you are just starting out, make sure you put a high emphasis on testing your application, otherwise you are going to end up with a bunch of code that has never been tested and you will find yourself writing code for weeks just to get partial coverage on the code you’ve already written. Starting off on the right foot is a much better approach, and you will find life much more enjoyable.</p>

<p>Let’s get started…</p>

<p>First of all, you need to define your models:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>

<span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">"news_post"</span><span class="p">)</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>
    <span class="n">users_read</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">"users"</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span></code></pre></div>

<p>What we have done here is created a news post item. Let’s test it!</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">PostTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">fixtures</span> <span class="o">=</span> <span class="p">[</span><span class="s">'test_data.json'</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s">'newsposter'</span><span class="p">,</span>
                                             <span class="s">'newsposter@news.com'</span><span class="p">,</span> <span class="s">'newspass'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Test Post #1"</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="s">"Test Post #1 Body"</span><span class="p">,</span>
                <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
                <span class="n">date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">test_post_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""
        Tests that we can create a Post
        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="s">"Test Post #1"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">author</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_user_can_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""
        Tests that a user is allowed to read.
        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">'newsposter'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">'newspass'</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/news/get_post/1/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s">'{}'</span><span class="p">)</span></code></pre></div>

<p>One of the really cool thing about testing with django is that it comes with a testing client that allows you to make requests just like a real user would. As you can see in our <code>test_user_can_read()</code> method, we have used the client to make a GET request against a URL. You can make a POST request just as easily:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">test_i_read_this</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s">"""
    Tests a new user marking the story as read.
    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">'newsposter'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">'newspass'</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/news/read/1/'</span><span class="p">,</span> <span class="p">{</span><span class="s">'add'</span><span class="p">:</span><span class="bp">True</span><span class="p">})</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s">'{</span><span class="se">\n</span><span class="s">    "read": true</span><span class="se">\n</span><span class="s">}'</span><span class="p">)</span></code></pre></div>

<p>In the previous code sample, the client sends a POST request to <code>/news/read/1/</code> with the <code>{'add':True}</code> data. This gets converted to form data and submitted via the POST. The request returns back JSON, which we match up against what we expect it to return.</p>

<p>Here are some things to remember when you are writing your test cases:</p>

<ul>
  <li>
    <p><code>setUp()</code> gets called before <strong>every</strong> test method in your TestCase.</p>
  </li>
  <li>
    <p><code>tearDown()</code> gets called after <strong>every</strong> test method in your TestCase.</p>
  </li>
  <li>
    <p>Test methods <strong>must</strong> start with “test” otherwise they will not be executed. It is safe to have other methods in your TestCase that do not begin with “test” if you want to abstract functionality for multiple test methods into a single function.</p>
  </li>
  <li>
    <p>Django creates a test database for you, populates it, runs any south migrations (if you are using south), and then destroys it.</p>
  </li>
  <li>
    <p>Do not expect that data that is available in one of your test methods will be available in another. Each test method starts with a blank data slate. If you need data instantiated before your tests are run, consider using the <code>setUp()</code> and <code>tearDown()</code> methods, or using fixtures. You can specify fixtures other than your initial_data fixtures by adding <code>fixtures = ['test_data.json']</code> to your TestCase class.</p>
  </li>
</ul>

<p>Here is in-depth documentation about what assert methods are available to you in different versions of Python in <a href="http://docs.python.org/library/unittest.html#test-cases">the official Python unittest documentation</a>.</p>

<p>As you can see, testing with django is really really simple, but very powerful. In my next post, I will discuss how to test django with a MongoDB backend that does not use the ORM.</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2011-01-31T08:58:05+00:00"><a href="/2011/01/31/code-completion-for-python-and-django-in-vim/">January 31, 2011</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Ben Belchak">Ben Belchak</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~3 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2011/01/31/code-completion-for-python-and-django-in-vim/" rel="bookmark" title="Code Completion (IntelliSense) in VIM" itemprop="url">Code Completion (IntelliSense) in VIM</a></h1>
    
  </header>
  <div class="entry-content">
    <p><a href="http://www.vim.org/">VIM</a> has been my editor of choice for at least 15 years. I love how fast I can edit files, perform menial tasks, and wreak general havoc on any code project I am working on at any given moment. One of the things that I have missed about VIM from an IDE perspective has been code completion (a.k.a. “IntelliSense”). I have spent a lot of time on websites and man pages trying to figure out syntax and function names for several types of languages, and just recently discovered a long-included feature of VIM called omni completion, or Omnicomplete.</p>

<p>Since my life is mostly centered around <a href="http://www.djangoproject.com">django</a> these days, I will discuss how I’ve benefited from omnicomplete and how I’ve set it up in my own environment.</p>

<p>First, since django is a web development framework, I want to make sure that I can get omnicompletion for HTML, Python, JavaScript and CSS. Omnicompletion works for almost any programming language that VIM has syntax highlighting support for, and these languages are no exception.</p>

<p>Here’s what omnicomplete looks like for CSS files, for example:</p>

<p><img src="http://www.belchak.com/wp-content/uploads/2011/01/Screen-shot-2011-01-30-at-3.37.00-PM-1-30-11-300x213.png" width="300" alt="omnicomplete for vim" /></p>

<p>Setting this up for your django project is simple as pie. It is helpful to have all your django projects in one parent directory for the following setup. You can obviously customize this to your needs, but this is the way I’ve set it up in my environment.</p>

<p>Add the following to a script in a directory of your choosing (~/bin/vim_wrapper is where mine is):</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
<span class="nb">export </span><span class="nv">PROJECT</span><span class="o">=</span><span class="sb">`</span>python -c <span class="s2">"import os; print os.path.basename(os.getcwd())"</span><span class="sb">`</span>
<span class="nb">export </span><span class="nv">PYTHONPATH</span><span class="o">=</span><span class="s2">"/path/to/your/projects/parent/directory/"</span>
<span class="nb">export </span><span class="nv">DJANGO_SETTINGS_MODULE</span><span class="o">=</span><span class="nv">$PROJECT</span>.settings vim
<span class="nv">$@</span></code></pre></div>

<p>Then add the following line to your ~/.bash_profile or equivalent:</p>

<p><code>alias vi="vim_wrapper"</code></p>

<p>Or, you can call your vim_wrapper script by hand. (<code>vim_wrapper file_to_edit.py</code>)</p>

<p>Next, add the following lines to your ~/.vimrc file:</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="k">filetype</span> plugin <span class="k">on</span>
autocmd <span class="nb">FileType</span> python <span class="k">set</span> omnifunc<span class="p">=</span>pythoncomplete#Complete
autocmd <span class="nb">FileType</span> javascript <span class="k">set</span> omnifunc<span class="p">=</span>javascriptcomplete#CompleteJS
autocmd <span class="nb">FileType</span> html <span class="k">set</span> omnifunc<span class="p">=</span>htmlcomplete#CompleteTags
autocmd <span class="nb">FileType</span> css <span class="k">set</span> omnifunc<span class="p">=</span>csscomplete#CompleteCSS</code></pre></div>

<p>I also prefer to re-map the default key binding (<c-x><c-o>) to <c-space>, so I accomplish this by also adding the following line to my ~/.vimrc file: `inoremap <c-space> <c-x><c-o>`</c-o></c-x></c-space></c-space></c-o></c-x></p>

<p>I also found <a href="http://blogs.gnome.org/lharris/2008/07/20/code-completion-with-vim-7/">this trick</a> today while searching around…</p>

<blockquote>
  <p>What this function does is that if there is no completion that could happen it will insert a tab.  Otherwise it checks to see if there is an omnifunction available and, if so, uses it. Otherwise it falls back to Dictionary completion if there is a dictionary defined.  Finally it resorts to simple known word completion.  In general, hitting the Tab key will just do the right thing for you in any given situation.</p>
</blockquote>

<p>Add the following to your ~/.vimrc and you should be good to go. It works like a charm for me.</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="k">function</span><span class="p">!</span> SuperCleverTab<span class="p">()</span>
    <span class="k">if</span> strpart<span class="p">(</span>getline<span class="p">(</span><span class="s1">'.'</span><span class="p">),</span> <span class="m">0</span><span class="p">,</span> <span class="k">col</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span> <span class="p">-</span> <span class="m">1</span><span class="p">)</span> <span class="p">=~</span> <span class="s1">'^\s*$'</span>
        <span class="k">return</span> <span class="s2">"\"</span>
    <span class="k">else</span>
        <span class="k">if</span> &amp;omnifunc <span class="p">!=</span> <span class="s1">''</span>
            <span class="k">return</span> <span class="s2">"\\"</span>
        <span class="k">elseif</span> &amp;dictionary <span class="p">!=</span> <span class="s1">''</span>
            <span class="k">return</span> <span class="s2">"\"</span>
        <span class="k">else</span>
            <span class="k">return</span> <span class="s2">"\"</span>
        <span class="k">endif</span>
    <span class="k">endif</span>
<span class="k">endfunction</span>

inoremap <span class="p">&lt;</span>Tab<span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>R<span class="p">&gt;=</span>SuperCleverTab<span class="p">()&lt;</span><span class="k">cr</span><span class="p">&gt;</span></code></pre></div>

<p>If you find yourself writing code in other languages, the following lines in your vimrc should be adequate:</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="k">filetype</span> plugin <span class="k">on</span>
<span class="k">set</span> ofu<span class="p">=</span>syntaxcomplete#Complete</code></pre></div>

<p>You can now test that your installation works by changing directories to one of your django projects, firing up vim and running the following command: <code>:python from django import db</code></p>

<p>If you do not get a horrible error, you are good to go!</p>

<p>You can now access code completion by the following methods:</p>

<ul>
  <li>
    <p><code>&lt;C-p&gt;</code> - Shows a list of all local symbols. This is good if you do not have a tags file associated with the file you are editing.</p>
  </li>
  <li>
    <p><code>&lt;C-space&gt;</code> - Shows a list of all available symbols. You need to set up a tags file, which is outside the scope of this blog post</p>
  </li>
  <li>
    <p><code>&lt;C-x&gt;&lt;C-o&gt;</code> - The original keystroke sequence that we re-mapped C-space to.</p>
  </li>
  <li>
    <p><code>&lt;Tab&gt;</code> - The all-powerful tab!`</p>
  </li>
</ul>

<p>I hope you enjoy your new-found power with vim as much as I do!</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    
      
        <li><a href="" class="btn">Previous</a></li>
      
    

    
    
      <li><a href="">1</a></li>
    

    
    

    
    
    

    
      
        <li><strong class="current-page">2</strong></li>
      
    

    
    

    
      <li><a href="/page3/">3</a></li>
    

    
    
      <li><a href="/page3/" class="btn">Next</a></li>
    
  </ul>
</div>

</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2016 Ben Belchak. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-20863470-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>


          

</body>
</html>